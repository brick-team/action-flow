<?xml version="1.0" encoding="UTF-8"?>
<ae>
    <params>
        <param group="a">
            <key>username</key>
            <value>username</value>
        </param>

        <param group="a">
            <key>password</key>
            <value>password</value>
        </param>
    </params>
    <actions>
        <action id="login" class="com.github.huifer.LoginAction" method="login">
            <param index="0" arg_name="username" param_group="a" ex="username"
                   type="java.lang.String"/>
            <param index="1" arg_name="password" param_group="a" ex="password"
                   type="java.lang.String"></param>
        </action>
        <action id="sendPoint" class="com.github.huifer.SendPointAction"
                method="sendPoint">
            <param index="0" arg_name="uid" param_group="a" ex="username" type="java.lang.String">
            </param>
            <param index="1" arg_name="point" value="10" type="java.lang.Integer">
                <format id="f1" class="com.github.huifer.StringToIntegerFormat"></format>
            </param>
        </action>
    </actions>

    <watchers>
        <watcher id="w1" exid="e3" condition="> 10">
            <then actionId="sendPoint"/>
            <catch actionId="sendPoint"/>
        </watcher>
    </watchers>

    <result>
        <key name="r1" exid="e1"/>
        <key name="r2" exid="e2"/>
    </result>

    <extracts>
        <extract id="e1" fromAction="login" el="$.username"/>
        <extract id="e2" fromAction="login" el="$.login_time"/>
        <extract id="e3" fromAction="login" el="$.age"/>
    </extracts>

    <flow>
        <work id="work1" type="action" ref_id="login">
            <catch>
                <work id="work2" type="watcher" ref_id="w1">
                </work>
            </catch>
            <then>
                <work id="work2" type="watcher" ref_id="w1">
                    <then>
                        <work id="work3" type="watcher" ref_id="w1"/>
                    </then>
                </work>
                <work id="work2" type="watcher" ref_id="w1">
                    <then>
                        <work id="work3" type="watcher" ref_id="w1"/>
                    </then>
                    <catch>
                        <work id="work3" type="watcher" ref_id="w1"/>
                    </catch>

                </work>
            </then>
            <!--            <then>-->
            <!--                <work id="work2" type="watcher" ref_id="w1">-->
            <!--                    <then>-->
            <!--                        <work id="work3" type="watcher" ref_id="w1"/>-->
            <!--                    </then>-->
            <!--                </work>-->
            <!--                <work id="work2" type="watcher" ref_id="w1">-->
            <!--                    <then>-->
            <!--                        <work id="work3" type="watcher" ref_id="w1"/>-->
            <!--                    </then>-->
            <!--                </work>-->
            <!--            </then>-->

        </work>


        <work id="22" type="action" ref_id="login">
            <then>
                <work id="work2" type="watcher" ref_id="w1">
                    <then>
                        <work id="work3" type="watcher" ref_id="w1"/>
                    </then>
                </work>

                <work id="work2" type="watcher" ref_id="w1">
                    <then>
                        <work id="work3" type="watcher" ref_id="w1"/>
                    </then>
                </work>
            </then>
        </work>


    </flow>

</ae>